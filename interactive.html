<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Water Smarter</title>
    <link rel="stylesheet" href="actual python ships/a.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Text:ital@0;1&display=swap" rel="stylesheet">
    <link rel="icon" href="pictures/logo (1).ico" type="image/ico">
</head>

<body>
    <div class="navlinks">
        <ul>
            <a href="index.html">
                <li>Home</li>
            </a>
            <a href="index copy.html">
                <li>It's the Law!</li>
            </a>
            <a href="interactive.html">
                <li>Water Calendar</li>
            </a>
        </ul>
    </div>

    <div class="container">
        <div class="alarm-settings">
            <label for="plant-select">Select Plant:</label>
            <select id="plant-select">
                <option value="rose">Rose</option>
                <option value="tulip">Tulip</option>
                <option value="cactus">Cactus</option>
                <option value="orchid">Orchid</option>
            </select>

            <input type="date" id="alarm-date">
            <input type="time" id="alarm-time">

            <div class="recurring-days">
                <label>Repeat on:</label>
                <input type="checkbox" id="monday" name="recurring" value="1">
                <label for="monday">Monday</label>

                <input type="checkbox" id="tuesday" name="recurring" value="2">
                <label for="tuesday">Tuesday</label>

                <input type="checkbox" id="wednesday" name="recurring" value="3">
                <label for="wednesday">Wednesday</label>

                <input type="checkbox" id="thursday" name="recurring" value="4">
                <label for="thursday">Thursday</label>

                <input type="checkbox" id="friday" name="recurring" value="5">
                <label for="friday">Friday</label>

                <input type="checkbox" id="saturday" name="recurring" value="6">
                <label for="saturday">Saturday</label>
            </div>

            <button id="set-alarm">Set Alarm</button>
        </div>

        <div class="calendar">
            <div class="calendar-header">
                <button id="prev-month">Prev</button>
                <h2 id="current-month"></h2>
                <button id="next-month">Next</button>
            </div>
            <div class="calendar-body">
                <table id="calendar-table">
                    <thead>
                        <tr>
                            <th>Sun</th>
                            <th>Mon</th>
                            <th>Tue</th>
                            <th>Wed</th>
                            <th>Thu</th>
                            <th>Fri</th>
                            <th>Sat</th>
                        </tr>
                    </thead>
                    <tbody id="calendar-dates">
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <script>
        const plantSelect = document.getElementById('plant-select');
        var alarmSound = new Audio('BGM.wav'); // Load the alarm sound
        const prevMonthBtn = document.getElementById('prev-month');
        const nextMonthBtn = document.getElementById('next-month');
        const currentMonthDisplay = document.getElementById('current-month');
        const calendarDates = document.getElementById('calendar-dates');
        const alarmDateInput = document.getElementById('alarm-date');
        const alarmTimeInput = document.getElementById('alarm-time');
        const setAlarmBtn = document.getElementById('set-alarm');
        let alarmDates = []; // Array to store alarm dates
        let currentDate = new Date();


        // Function to display the calendar
        function displayCalendar(year, month) {
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDay = firstDay.getDay();

            currentMonthDisplay.textContent = `${new Date(year, month).toLocaleString('default', { month: 'long' })} ${year}`;
            calendarDates.innerHTML = '';

            let date = 1;
            for (let i = 0; i < 6; i++) {
                const row = document.createElement('tr');
                for (let j = 0; j < 7; j++) {
                    if (i === 0 && j < startingDay) {
                        const cell = document.createElement('td');
                        cell.textContent = '';
                        row.appendChild(cell);
                    } else if (date > daysInMonth) {
                        break;
                    } else {
                        const cell = document.createElement('td');
                        cell.textContent = date;
                        // Convert the date to a string in the same format as alarmDate
                        const currentDateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(date).padStart(2, '0')}`;

                        // Check if the current date is in the alarmDates array
                        if (alarmDates.includes(currentDateStr)) {
                            cell.classList.add('alarm-dot'); // Add the alarm-dot class
                        }
                        row.appendChild(cell);
                        date++;
                    }
                }
                calendarDates.appendChild(row);
                if (date > daysInMonth) {
                    break;
                }
            }
        }

        // Event listeners for month navigation buttons
        prevMonthBtn.addEventListener('click', () => {
            currentDate.setMonth(currentDate.getMonth() - 1);
            displayCalendar(currentDate.getFullYear(), currentDate.getMonth());
        });

        nextMonthBtn.addEventListener('click', () => {
            currentDate.setMonth(currentDate.getMonth() + 1);
            displayCalendar(currentDate.getFullYear(), currentDate.getMonth());
        });

        // Event listener for the set alarm button
        setAlarmBtn.addEventListener('click', () => {
            console.log('setAlarmBtn clicked');
            const alarmDate = alarmDateInput.value;
            const alarmTime = alarmTimeInput.value;
            const selectedPlant = plantSelect.value; // Get the selected plant

            if (alarmDate && alarmTime) {
                const alarmDateTime = `${alarmDate}T${alarmTime}`;
                const selectedDate = new Date(alarmDate);
                const dayOfWeek = selectedDate.getDay();

                console.log(dayOfWeek);
                if (dayOfWeek === 6) {
                    alert('Sorry, you cannot set an alarm on Sunday.');
                    return;
                }

                // Calculate the time difference between now and the alarm time
                const now = new Date();
                const alarm = new Date(alarmDateTime);
                const timeDiff = alarm.getTime() - now.getTime();

                if (timeDiff > 0) {
                    // Add the alarm date to the array
                    alarmDates.push(alarmDate);
                    console.log('Alarm set for:', alarmDate);
                    console.log('All alarm dates:', alarmDates);

                    setTimeout(() => {
                        alarmSound.play(); // Play the alarm sound
                        setTimeout(() => {
                            alert(`Time to water the ${selectedPlant}!`); // Display the alarm message
                            alarmSound.pause(); // Stop the alarm sound
                            alarmSound.currentTime = 0;
                            console.log("closed...");
                        }, 250);
                    }, timeDiff);
                } else {
                    alert('Please select a future time for the alarm.');
                }

            } else {
                alert('Please select a date, time, and name for the alarm.');
            }
            displayCalendar(currentDate.getFullYear(), currentDate.getMonth());
        });

        // Initial calendar display
        displayCalendar(currentDate.getFullYear(), currentDate.getMonth());
    </script>
</body>

</html>